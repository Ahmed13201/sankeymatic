<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>SankeyMATIC &alpha;</title>
<link rel="stylesheet" href="main.css">
</head>
<body>

<!-- script src="http://d3js.org/d3.v2.min.js?2.9.1"></script -->
<script src="d3.v2.js"></script>
<script src="sankey.js"></script>
<script src="canvg.js"></script>
<script src="rgbcolor.js"></script>
<script src="sankeymatic.js"></script>

<div class="center_basic">

<table><tr><td>

<form onsubmit="process_sankey(); return false;">

<table class="center_basic">
<tr>
    <th id="title">SankeyMATIC
    <span style="margin:0; font-weight: normal; font-size:normal; font-style: italic;">alpha</span>
    </th>
</tr>
<tr>
    <td id="flows_entry">
    <textarea id="flows_in" rows="25" cols="40" onchange="process_sankey();">' Type a list of Flows, like this:
'     SOURCE [AMOUNT] TARGET
' Examples:
Here [8] Everywhere
There [5.5] Everywhere
Everywhere [6] Over there
Everywhere [5] Somewhere else
Far far away [3] Nearby

' To set a specific Node's color, type:
'     :NODENAME #COLOR
' Example:
:There #FC0

' To set a color for one specific Flow, add
' an HTML color code to the end of the line:
'     SOURCE [AMOUNT] TARGET #COLOR
' Example:
Everywhere [2.5] Nearby #F00

' Once your Nodes &amp; Flows are entered, use
' the controls below to further change the
' graph's style.</textarea>

<p class="center_basic"><button id="preview_graph" type="submit">Preview</button></p>

</td>
</tr>

<tr>
<td id="other_entry">

<p class="ui_head" onclick="toggle('diagram_options');"><span id="diagram_options_indicator" class="indicator">&uArr;</span>
Diagram options<span id="diagram_options_hint">:</span></p>

<div id="diagram_options" class="form_chunk">
<p class="form_elements1"><strong>Size</strong> (pixels):
<label for="canvas_width">Width =</label> <input type="text" id="canvas_width" size="5" maxlength="6" value="700" onchange="process_sankey();">
<label for="canvas_height">Height =</label> <input type="text" id="canvas_height" size="5" maxlength="6" value="400" onchange="process_sankey();">
</p>

<p class="form_elements2"><span style="line-height: 0;"><strong>Font:</strong> Size</span>
<input type="text" id="font_size" size="2" maxlength="4" value="12" onchange="process_sankey();"> <label for="font_size">px</label>

&nbsp;&nbsp;&nbsp;<span style="font-weight: lighter;" class="smalllabel">Light</span><input id="font_weight" type="range" min="100" max="700" step="300" value="400" onchange="process_sankey();" class="narrowslider"><span style="font-weight: bolder;" class="smalllabel">Bold</span>
</p>

<p class="form_elements1">
<input type="checkbox" id="flow_cross_check" value="1" onchange="process_sankey();" checked="checked">
<label for="flow_cross_check"><strong>Flow Cross-Check:</strong> Verify that the graph adds up.</label><br />
</p>
</div>

<p class="ui_head" onclick="toggle('flow_options');"><span id="flow_options_indicator" class="indicator">&dArr;</span>
Flow options<span id="flow_options_hint">...</span></p>

<div id="flow_options" class="form_chunk" style="display: none;">
<p class="form_elements1">
<strong>Default Flow colors:</strong><br />
<input name="default_flow_inherit" type="radio" id="flow_inherit_from_source" value="source" checked="checked" onchange="process_sankey();" /><label for="flow_inherit_from_source">Inherit
from Source node's color</label><br />
<input name="default_flow_inherit" type="radio" id="flow_use_color" value="none" onchange="process_sankey();" /><label for="flow_use_color">Use color:</label> 
<input type="text" id="default_flow_color" size="7" maxlength="7" value="#666" onchange="process_sankey();"><br />
<input name="default_flow_inherit" type="radio" id="flow_inherit_from_target" value="target" onchange="process_sankey();" /><label for="flow_inherit_from_target">Inherit
from Target node's color</label>
</p>

<p class="form_elements2">
<label for="default_flow_opacity"><strong>Default Flow Opacity:</strong></label>
<span class="smalllabel">0.0</span><input id="default_flow_opacity" type="range" min="0" max="1" step="0.1" value="0.3" onchange="process_sankey();" class="narrowslider"><span class="smalllabel">1.0</span>
</p>
</div>

<p class="ui_head" onclick="toggle('node_options');"><span id="node_options_indicator" class="indicator">&dArr;</span>
Node options<span id="node_options_hint">...</span></p>

<div id="node_options" class="form_chunk" style="display: none;">
<p class="form_elements1">
<strong>Labels:</strong>
<label for="unit_prefix">Units Prefix =</label> <input type="text" id="unit_prefix" size="3" maxlength="10" onchange="process_sankey();">
<label for="unit_suffix">Suffix =</label> <input type="text" id="unit_suffix" size="5" maxlength="10" onchange="process_sankey();"><br />

&nbsp; <input type="checkbox" id="include_values_in_node_labels" value="1" onchange="process_sankey();" checked="checked">
<label for="include_values_in_node_labels">Show values as part of node labels</label>
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" id="display_full_precision" value="1" onchange="process_sankey();">
<label for="display_full_precision">Always use full precision
<small>(e.g. for currency: $DD.cc)</small></label>
<br />
&nbsp; <input type="checkbox" id="hide_labels" value="1" onchange="process_sankey();">
<label for="hide_labels">Hide labels</label> <small>(to apply your own text to the graph)</small>
</p>

<p class="form_elements2">
<label for="node_width"><strong>Width:</strong></label>
<input type="text" id="node_width" size="2" maxlength="4" value="10" onchange="process_sankey();"> px

&nbsp; &nbsp;

<label for="node_padding"><strong>Space between:</strong></label>
<input type="text" id="node_padding" size="2" maxlength="4" value="15" onchange="process_sankey();"> px
</p>

<p class="form_elements1">
<label for="node_border"><strong>Border:</strong></label>
<select id="node_border" onchange="process_sankey();">
<option value="0" selected="selected">0px</option>
<option value="1">1px</option>
<option value="2">2px</option>
<option value="3">3px</option>
<option value="4">4px</option>
<option value="5">5px</option>
</select>
</p>

<p class="form_elements2">
<label for="default_node_opacity"><strong>Opacity:</strong></label>
<span class="smalllabel">0.0</span><input id="default_node_opacity" type="range" min="0" max="1" step="0.1" value="0.9" onchange="process_sankey();" class="narrowslider"><span class="smalllabel">1.0</span>
</p>
</div>

<p class="ui_head" onclick="toggle('advanced_options');"><span id="advanced_options_indicator" class="indicator">&dArr;</span>
Advanced Formatting<span id="advanced_options_hint">...</span></p>

<div id="advanced_options" class="form_chunk" style="display: none;">
<p class="form_elements1">
<strong>Diagram Scale</strong> = <span id="scale_figures"></span><br />
(For fair comparisons between diagrams, make their<br />
Units and Scale match as closely as possible.)
</p>

<p class="form_elements2">
<strong>Inner Margin</strong> (pixels):<br />
&nbsp;&nbsp; <label for="top_margin">Top</label>
<input type="text" id="top_margin" size="2" maxlength="4" value="15" onchange="process_sankey();">
<label for="right_margin">Right</label>
<input type="text" id="right_margin" size="2" maxlength="4" value="15" onchange="process_sankey();">
<label for="bottom_margin">Bottom</label>
<input type="text" id="bottom_margin" size="2" maxlength="4" value="15" onchange="process_sankey();">
<label for="left_margin">Left</label>
<input type="text" id="left_margin" size="2" maxlength="4" value="15" onchange="process_sankey();">
</p>

<p class="form_elements1"><strong>Note:</strong> You can drag nodes around. (However, changing<br />
any inputs will re-draw the whole diagram.)</p>

<p class="form_elements2">
<input type="checkbox" id="reverse_graph" value="1" onchange="process_sankey();">
<label for="reverse_graph"><strong>Reverse the graph</strong> (flow right-to-left)</label>
</p>
</div>

<p class="ui_head" onclick="toggle('export_options');"><span id="export_options_indicator" class="indicator">&uArr;</span>
Export options<span id="export_options_hint">:</span></p>

<div id="export_options" class="form_chunk">
<div class="form_elements1">
<p class="form_elements">Once you are satisfied with your diagram, you can<br />
<strong>export it as a .PNG image</strong>:</p>
<p class="center_para"><strong>Scale:</strong>
<input name="scale_x" type="radio" value="1" checked="checked" onchange="update_png();" />1x (Web)
<input name="scale_x" type="radio" value="2" onchange="update_png();" />2x (Retina)
<input name="scale_x" type="radio" value="4" onchange="update_png();" />4x (Print)</p>
<p class="center_para" id="download_link"><a href="#" id="download_png" download="sankey.png">...</a></p>
</div>
</div>

</td>
</tr>
</table>

</form>

</td><td id="grapharea">

<table id="messages">
<tr><td id="messages_area"></td></tr>
</table>

<p id="chart">
<svg id="the_svg" height="400" width="700" xmlns="http://www.w3.org/2000/svg" version="1.1"></svg>
</p>
<canvas id="png_preview" height="400" width="700" style="background: #FFF; display:none;"></canvas>
<div id="chartfooter">
</div>
</td></tr></table>

<p class="center_para">
Questions? Bugs? Suggestions? Tell <a href="https://twitter.com/sankeymatic" target="_blank">@SankeyMATIC</a> on Twitter.
</p>

<p class="center_para">
SankeyMATIC is produced by <a href="http://nowthis.com/" target="_blank">Steve Bogart</a> (<a href="https://twitter.com/nowthis" target="_blank">@nowthis</a>).
It is built on top of the
<a href="http://bost.ocks.org/mike/sankey/" target="_blank">Sankey library</a> of <a
href="http://d3js.org/" target="_blank">D3.js</a>.
</p>

</div>

<script>
process_sankey(); // render on page load
</script>

</body></html>
